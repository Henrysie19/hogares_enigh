---
title: "Ingresos y Gastos de los Hogares en México"
author: "Henry Sierra"
date: "2023-07-28"
output: 
  html_document: 
    fig_height: 7
    fig_width: 10
    highlight: tango
    keep_md: yes
    number_sections: yes
    theme: cerulean
    toc: yes
    toc_depth: 4
    toc_float:
      collapsed: no
      smooth_scroll: yes
  pdf_document:
    toc: yes
    toc_depth: '4'
  word_document:
    toc: yes
    toc_depth: '4'
editor_options:
  
  chunk_output_type: console
---

```{=html}
<style>
body {
text-align: justify}
</style>
```

------------------------------------------------------------------------

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

packages<-c("pander","kableExtra","magrittr")
sapply(packages,require,character.only=TRUE)

library(readxl)
library(readxlsb)
library(tidyverse)
library(pander)
library(ggplot2)

# Directorio
setwd("C:/Users/ASUS/OneDrive/Documentos/myrepo/hogres_enigh")

#Leer el archivo
enigh<-read_xlsx("hogares_enigh.xlsx")

```

Para este ejercicio, estaremos trabajando con la data Hogares_enight (Encuesta Nacional de Ocupación y Empleo de México) Realizando un pequeño analisis exploratorio de los datos:

## DATA

```{r enigh}
enigh%>%head()%>%pander() 
```

# realizamos un resumen estadistico de la data que usaremos (salud, alimentos, ingreso_per_capita)

```{r pander, echo=FALSE}
summary(enigh[c('salud', 'alimentos', 'ingreso_per_capita')])%>%pander() 
```

## PLOTS

Iniciamos con los histogramas de los datos que usaremos (salud, alimentos, ipc)

Histograma de Gastos en Salud distribuidos por estrato socioeconomico

```{r histograma_Salud, echo=FALSE}
ggplot(enigh) +                                                                      
  geom_histogram(bins = 50, aes(x = enigh$ln_salud, fill = est_socio), color = 'black') + 
  facet_grid(est_socio~., scales = 'free') +
  xlab("Estrato Socioeconomico") + 
  ylab("Frecuencia") + 
  ggtitle("Distribución de Gastos en Salud") +
  theme_minimal()
```

Histograma de Gastos en Alimentos distribuidos por estrato socioeconomico

```{r histograma_Alimentos, echo=FALSE}
ggplot(enigh) + 
  geom_histogram(bins = 50, aes(x = ln_alimentos, fill = est_socio), color = 'black') + 
  facet_grid(est_socio~., scales = 'free') +
  xlab("Estrato Socioeconomico") + 
  ylab("Frecuencia") + 
  ggtitle("Distribución de Gastos en Alimentos") +
  theme_minimal()

```

Histograma de Ingreso Per Capita distribuidos por estrato socioeconomico

```{r histograma_IPC, echo=FALSE}
hist(enigh$ln_ipc, main = "Histograma de IPC",
     xlab = "IPC", ylab = "Frecuencia",
     col = "purple")
```

Nota: 1= Hombre, 2= Mujer

# Graficas de Correlaciones Lineales

Ingreso Per Capita / Gastos en Alimentos, distribuidos por estratos

```{r Ingreso Per Capita / Gastos en Alimentos, echo=FALSE}
ggplot(enigh) + 
  geom_histogram(bins = 50, aes(x = ln_ipc, fill = sexo_jefe), color = 'black') + 
  facet_grid(sexo_jefe~., scales = 'free') +
  xlab("Estrato Socioeconomico") + 
  ylab("Frecuencia") + 
  ggtitle("Distribución de Ingresos Per Capita") +
  theme_minimal()
```

Ingreso Per Capita / Gastos en Salud, distribuidos por estratos

```{r Ingreso Per Capita / Gastos en Salud, echo=FALSE}
ggplot(data=enigh) +
  geom_point(mapping = aes(x=ln_ipc, y=ln_salud, color = est_socio)) +
  xlab("Estrato Socioeconomico") +
  ylab("Gastos en Alimentos") +
  ggtitle("Gráfico de Correlacion") +
  theme_minimal()
```

Al graficar podemos ver a simple vista que existe de alguna manera una correlación lineal entre las variables, pero esto no se sabe con exactitud hasta tener resumen de los datos. Para esto realizaremos un modelo linear o LinearModel

##Linear Model

modelos\<- lm(enigh$ln_salud ~ enigh$ln_ipc)

```{r modelos, echo=FALSE}
modelos<- lm(enigh$ln_salud ~ enigh$ln_ipc + enigh$ln_alimentos)
summary(modelos)%>%pander() 
```

el modelo de regresión lineal muestra que tanto el "IPC" como los "Gastos en Alimentos" tienen un impacto significativo en la variable de respuesta "Gastos en Saluda. Sin embargo, el R-cuadrado ajustado es relativamente bajo, lo que sugiere que las variables predictoras no explican una gran parte de la variabilidad en enigh\$ln_salud. Es importante considerar la interpretación de los coeficientes y el contexto del problema para evaluar la relevancia y significado práctico del modelo.
